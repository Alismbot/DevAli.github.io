<div id="series-container" style="height:100vh; overflow-y:scroll; scroll-snap-type:y mandatory; margin:0; padding:0;">
    <!-- الحلقات سيتم إضافتها تلقائيًا -->
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const params = new URLSearchParams(window.location.search);
    const seriesName = params.get("series"); // ?page=series&series=loveblack

    const container = document.getElementById("series-container");

    if (!seriesName) {
        container.innerHTML = "<h2>⚠️ لم يتم تحديد السلسلة</h2>";
        return;
    }

    const seriesPath = `assets/series/${seriesName}/`;

    // ✅ تحديد الحلقات هنا مباشرة
    const seriesEpisodes = {
        "loveblack": ["ep1.mp4", "ep2.mp4", "ep3.mp4"],
        // يمكن إضافة مسلسلات أخرى بنفس الشكل
        // "otherSeries": ["ep1.mp4", "ep2.mp4"]
    };

    const episodes = seriesEpisodes[seriesName];
    if (!episodes || episodes.length === 0) {
        container.innerHTML = "<h2>⚠️ لا توجد حلقات لهذا المسلسل</h2>";
        return;
    }

    // إنشاء الفيديوهات لكل حلقة
    episodes.forEach(epFile => {
        const div = document.createElement("div");
        div.className = "episode";
        div.style.height = "100vh";
        div.style.scrollSnapAlign = "start";

        const video = document.createElement("video");
        video.src = seriesPath + epFile;
        video.controls = true;
        video.style.width = "100%";
        video.style.height = "100%";
        video.style.objectFit = "cover";

        div.appendChild(video);
        container.appendChild(div);
    });

    // تشغيل/إيقاف الفيديو عند ظهوره/اختفائه
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) entry.target.play();
            else entry.target.pause();
        });
    }, { threshold: 0.7 });

    document.querySelectorAll("video").forEach(video => observer.observe(video));
});
</script>
