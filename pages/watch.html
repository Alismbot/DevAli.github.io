<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Watch Series</title>

<style>
body {
    margin: 0;
    padding: 0;
    background: #000;
    overflow: hidden;
    font-family: Arial, sans-serif;
}

.watch-container {
    position: relative;
    width: 100%;
    height: 100vh;
    background: #000;
    color: #fff;
}

#series-title {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 22px;
    z-index: 20;
    background: rgba(0,0,0,0.6);
    padding: 5px 15px;
    border-radius: 10px;
}

.video-feed {
    width: 100%;
    height: 100%;
    overflow-y: scroll;
    scroll-snap-type: y mandatory;
}

.video-feed video {
    width: 100%;
    height: 100vh;
    object-fit: cover;
    scroll-snap-align: start;
    background: #000;
}

.side-buttons {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    flex-direction: column;
    gap: 15px;
    z-index: 30;
}

.side-buttons button {
    background: rgba(17,17,17,0.7);
    color: #00e676;
    border: none;
    padding: 10px 12px;
    border-radius: 12px;
    font-size: 22px;
    cursor: pointer;
    transition: all 0.2s;
}

.side-buttons button:hover {
    background: #00e676;
    color: #111;
}
</style>
</head>
<body>

<div class="watch-container">
    <h1 id="series-title"></h1>

    <div class="video-feed" id="video-feed">
        <!-- Ÿäÿ™ŸÖ ÿ•ÿØÿÆÿßŸÑ ÿßŸÑŸÅŸäÿØŸäŸàŸáÿßÿ™ ŸáŸÜÿß ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã -->
    </div>

    <div class="side-buttons">
        <button id="like-btn">‚ù§Ô∏è</button>
        <button id="episodes-btn">üì∫</button>
        <button id="share-btn">üîó</button>
    </div>
</div>

<script>
/* --------------------------
   1) ÿ¨ŸÑÿ® ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ŸÑÿ≥ŸÑ ŸÖŸÜ ÿßŸÑÿ±ÿßÿ®ÿ∑
--------------------------- */
const params = new URLSearchParams(window.location.search);
const seriesName = params.get('series') || 'loveblack';
document.getElementById('series-title').innerText = seriesName;

/* --------------------------
   2) ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ≠ŸÑŸÇÿßÿ™
--------------------------- */
const episodes = [
    'ep1.mp4',
    'ep2.mp4',
    'ep3.mp4'
];

const feed = document.getElementById('video-feed');

/* --------------------------
   3) ÿ•ÿØÿÆÿßŸÑ ÿßŸÑŸÅŸäÿØŸäŸàŸáÿßÿ™ ÿØÿßÿÆŸÑ ÿßŸÑÿµŸÅÿ≠ÿ©
--------------------------- */
episodes.forEach(ep => {
    const video = document.createElement('video');

    video.src =
        `https://raw.githubusercontent.com/Alismbot/DevAli.github.io/main/assets/series/${seriesName}/${ep}?raw=1`;

    video.playsInline = true;
    video.controls = false;
    video.autoplay = false;
    video.loop = false;
    video.preload = "metadata";

    feed.appendChild(video);
});

/* --------------------------
   4) Scroll Snap ÿßŸÑŸäÿØŸàŸä
   ŸäŸÖŸÜÿπ ÿ™ÿ¨ÿßŸàÿ≤ 3 ŸÅŸäÿØŸäŸàŸáÿßÿ™ ŸÖÿ±ÿ© Ÿàÿßÿ≠ÿØÿ©
--------------------------- */
let lockScroll = false;

feed.addEventListener('scroll', () => {
    if (lockScroll) return;

    lockScroll = true;

    setTimeout(() => {
        const pos = feed.scrollTop;
        const vh = window.innerHeight;
        const index = Math.round(pos / vh);

        feed.scrollTo({
            top: index * vh,
            behavior: "smooth"
        });

        lockScroll = false;
    }, 120);
});

/* --------------------------
   5) ÿ™ÿ¥ÿ∫ŸäŸÑ ŸÅŸäÿØŸäŸà Ÿàÿßÿ≠ÿØ ŸÅŸÇÿ∑
--------------------------- */
const observer = new IntersectionObserver(
    entries => {
        entries.forEach(entry => {
            const video = entry.target;

            if (entry.isIntersecting && entry.intersectionRatio > 0.7) {
                video.play().catch(()=>{});
            } else {
                video.pause();
            }
        });
    },
    { threshold: [0.7] }
);

// ÿ™ŸÅÿπŸäŸÑ ÿßŸÑŸÖÿ±ÿßŸÇÿ®ÿ© ÿ®ÿπÿØ ÿ•ÿØÿÆÿßŸÑ ÿßŸÑŸÅŸäÿØŸäŸàŸáÿßÿ™
setTimeout(() => {
    document.querySelectorAll("video").forEach(v => observer.observe(v));
}, 300);
</script>

</body>
</html>
