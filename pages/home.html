<div class="home-container">
    <h1 data-text="title"></h1>
    <p data-text="description"></p>

    <div class="social-buttons">
        <a class="btn" href="https://t.me/WAMOD17" target="_blank">
            <img src="telegram.png" class="icon"> 
            <span data-text="telegram"></span>
        </a>

        <a class="btn" href="https://whatsapp.com/channel/..." target="_blank">
            <img src="whatsapp.png" class="icon"> 
            <span data-text="whatsapp"></span>
        </a>

        <a class="btn" href="https://youtube.com/@..." target="_blank">
            <img src="youtube.png" class="icon"> 
            <span data-text="youtube"></span>
        </a>
    </div>

    <p data-text="extra" class="extra-text"></p>

    <!-- مكان التيمبلات الديناميكية -->
    <div id="apps-container"></div>
</div>

<style>
.home-container {
    max-width: 800px;
    margin: 40px auto;
    padding: 20px;
    text-align: center;
    color: #fff;
    line-height: 1.7;
    font-size: 18px;
}

.home-container h1 {
    font-size: 40px;
    margin-bottom: 20px;
    color: #00e676;
}

.home-container p {
    font-size: 20px;
    margin-bottom: 20px;
}

.social-buttons {
    display: flex;
    justify-content: center;
    gap: 20px;
    flex-wrap: wrap;
    margin-bottom: 30px;
}

.extra-text {
    font-size: 18px;
    margin-top: 20px;
    color: #ffd700;
}

.social-buttons .btn {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    background-color: #111;
    color: #00e676;
    padding: 15px 25px;
    border-radius: 12px;
    font-size: 18px;
    font-weight: bold;
    text-decoration: none;
    transition: all 0.3s;
}

.social-buttons .btn:hover {
    background-color: #00c75a;
    color: #111;
}

.social-buttons .btn img.icon {
    width: 25px;
    height: 25px;
}

/* تيمبلت تلقائي */
.app-box {
    background: #111;
    padding: 20px;
    margin: 30px auto;
    border-radius: 15px;
    max-width: 700px;
    text-align: center;
}

.big-app-image {
    width: 100%;
    max-width: 600px;
    border-radius: 12px;
    cursor: pointer;
    transition: transform 0.3s;
}

.big-app-image:hover {
    transform: scale(1.03);
}

.app-desc {
    margin-top: 15px;
    font-size: 18px;
    color: #ffd700;
}
</style>

<script>
(async function(){
  const container = document.getElementById("apps-container");
  if (!container) return;

  // قائمة مسارات محتملة لـ Apps.json (بترتيب التجريب)
  const possiblePaths = [
    "pages/Apps.json",                            // نسبي (موصى به)
    "./pages/Apps.json",
    "/pages/Apps.json",
    "/DevAli.github.io/pages/Apps.json",          // مسار كامل لمستودعك كما ظهر سابقًا
    "DevAli.github.io/pages/Apps.json",
    "/DevAli.pages/Apps.json"                     // احتياطي (نادر)
  ];

  let apps = null;
  for (const p of possiblePaths) {
    try {
      console.log("Trying Apps.json at:", p);
      const res = await fetch(p, { cache: "no-store" });
      if (!res.ok) {
        console.warn("Not found:", p, res.status);
        continue;
      }
      apps = await res.json();
      console.log("Loaded Apps.json from:", p);
      break;
    } catch (err) {
      console.warn("Fetch error for", p, err);
    }
  }

  if (!apps) {
    container.innerHTML = '<p style="color:#f66">لم يتم العثور على ملف pages/Apps.json — تأكد من المسار واسم الملف. افتح Console لرؤية التفاصيل.</p>';
    return;
  }

  // Normalize apps: accept array or object map
  let list = [];
  if (Array.isArray(apps)) list = apps;
  else if (apps && typeof apps === "object") list = Object.keys(apps).map(k => Object.assign({ name: apps[k].name || k }, apps[k]));
  else {
    container.innerHTML = '<p style="color:#f66">تنسيق Apps.json غير صحيح.</p>';
    console.error("Apps.json format:", apps);
    return;
  }

  // Helper لبناء المسارات للصورة و الصفحة بشكل مرن
  function buildPageHref(page) {
    if (!page) return "#";
    // لو الصفحة تبدأ ب"http" أو "/" استخدمها كما هي
    if (page.startsWith("http") || page.startsWith("/")) return page;
    // لو تبدو اسم ملف داخل pages folder
    return `pages/${page}`;
  }
  function buildImageSrc(img) {
    if (!img) return "";
    if (img.startsWith("http") || img.startsWith("/")) return img;
    return `assets/Down/${img}`;
  }

  // توليد HTML
  const frag = document.createDocumentFragment();
  list.forEach(app => {
    if (!app.page || !app.image) return; // تجاهل الناقص
    const box = document.createElement("div");
    box.className = "app-box";

    const a = document.createElement("a");
    a.href = buildPageHref(app.page);

    const img = document.createElement("img");
    img.src = buildImageSrc(app.image);
    img.className = "big-app-image";
    img.alt = app.name || "app";

    a.appendChild(img);
    box.appendChild(a);

    const p = document.createElement("p");
    p.className = "app-desc";
    p.textContent = app.description || "";
    box.appendChild(p);

    frag.appendChild(box);
  });

  container.appendChild(frag);
})();
</script>
