<div class="watch-container">
    <h1 id="series-title"></h1>

    <div class="video-feed" id="video-feed">
        <!-- ÿßŸÑŸÅŸäÿØŸäŸàŸáÿßÿ™ ÿ™ŸàŸÑŸëÿØ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã -->
    </div>

    <!-- ÿ£ÿ≤ÿ±ÿßÿ± ÿ¨ÿßŸÜÿ®Ÿäÿ© -->
    <div class="side-buttons">
        <button id="like-btn">‚ù§Ô∏è</button>
        <button id="episodes-btn">üì∫</button>
        <button id="share-btn">üîó</button>
    </div>
</div>

<style>
.watch-container {
    position: relative;
    width: 100%;
    height: 100vh;
    background: #000;
    overflow: hidden;
    color: #fff;
    font-family: Arial, sans-serif;
}

#series-title {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 24px;
    z-index: 10;
}

.video-feed {
    width: 100%;
    height: 100%;
    overflow-y: scroll;
    scroll-snap-type: y mandatory;
}

.video-feed video {
    width: 100%;
    height: 100vh;
    object-fit: cover;
    scroll-snap-align: start;
    cursor: pointer;
}

.side-buttons {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    flex-direction: column;
    gap: 15px;
    z-index: 10;
}

.side-buttons button {
    background: rgba(17,17,17,0.7);
    color: #00e676;
    border: none;
    padding: 10px 12px;
    border-radius: 10px;
    font-size: 18px;
    cursor: pointer;
    transition: all 0.2s;
}

.side-buttons button:hover {
    background: #00e676;
    color: #111;
}
</style>

<script>
// ŸÇÿ±ÿßÿ°ÿ© ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ŸÑÿ≥ŸÑ ?series=loveblack
const params = new URLSearchParams(window.location.search);
const seriesName = params.get('series') || 'loveblack';
document.getElementById('series-title').innerText = seriesName;

// ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ≠ŸÑŸÇÿßÿ™ (RAW links)
const episodes = [
    `https://raw.githubusercontent.com/Alismbot/DevAli.github.io/main/assets/series/${seriesName}/ep1.mp4`,
    `https://raw.githubusercontent.com/Alismbot/DevAli.github.io/main/assets/series/${seriesName}/ep2.mp4`,
    `https://raw.githubusercontent.com/Alismbot/DevAli.github.io/main/assets/series/${seriesName}/ep3.mp4`
];

const feed = document.getElementById("video-feed");

// ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÅŸäÿØŸäŸàŸáÿßÿ™
episodes.forEach(url => {
    const vid = document.createElement("video");
    vid.src = url;
    vid.controls = false;
    vid.autoplay = false;
    vid.loop = false;
    feed.appendChild(vid);

    // ÿßŸÑÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ ÿßŸÑŸÅŸäÿØŸäŸà ŸÑÿ™ÿ¥ÿ∫ŸäŸÑŸá ÿ®ÿπÿØ ÿßŸÑÿ•ŸäŸÇÿßŸÅ
    vid.addEventListener('click', () => {
        document.querySelectorAll(".video-feed video").forEach((v) => {
            if (v !== vid) {
                v.pause();
                v.currentTime = 0;
            }
        });

        if (vid.paused) vid.play();
    });
});

// ------------- ŸÜÿ∏ÿßŸÖ Scroll Snap (TikTok style) ----------------

let isSnapping = false;

feed.addEventListener("scroll", () => {
    if (isSnapping) return;

    clearTimeout(feed.snapTimeout);

    feed.snapTimeout = setTimeout(() => {
        const scrollTop = feed.scrollTop;
        const vh = window.innerHeight;

        // ÿ≠ÿ≥ÿßÿ® ÿßŸÇÿ±ÿ® ŸÅŸäÿØŸäŸà
        const index = Math.round(scrollTop / vh);

        isSnapping = true;

        feed.scrollTo({
            top: index * vh,
            behavior: "smooth"
        });

        // ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑŸÅŸäÿØŸäŸà ÿßŸÑÿµÿ≠Ÿäÿ≠ ŸÅŸÇÿ∑
        document.querySelectorAll(".video-feed video").forEach((v, i) => {
            if (i === index) {
                v.play();
            } else {
                v.pause();
                v.currentTime = 0;
            }
        });

        setTimeout(() => {
            isSnapping = false;
        }, 350);

    }, 80);
});

// ÿ™ÿ¥ÿ∫ŸäŸÑ ÿ£ŸàŸÑ ŸÅŸäÿØŸäŸà ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ÿ®ÿπÿØ ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ
window.onload = () => {
    const firstVideo = document.querySelector(".video-feed video");
    if (firstVideo) firstVideo.play();
};
</script>
