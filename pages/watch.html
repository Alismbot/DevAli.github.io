<div class="watch-container">
    <h1 id="series-title"></h1>

    <div class="video-feed" id="video-feed">
        <!-- ÿßŸÑŸÅŸäÿØŸäŸàŸáÿßÿ™ ÿ™ŸàŸÑŸëÿØ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã -->
    </div>

    <!-- ÿ£ÿ≤ÿ±ÿßÿ± ÿ¨ÿßŸÜÿ®Ÿäÿ© -->
    <div class="side-buttons">
        <button id="like-btn">‚ù§Ô∏è</button>
        <button id="episodes-btn">üì∫</button>
        <button id="share-btn">üîó</button>
    </div>
</div>

<style>
.watch-container {
    position: relative;
    width: 100%;
    height: 100vh;
    background: #000;
    overflow: hidden;
    color: #fff;
    font-family: Arial, sans-serif;
}

#series-title {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 24px;
    z-index: 10;
}

.video-feed {
    width: 100%;
    height: 100%;
    overflow-y: scroll;
    scroll-snap-type: y mandatory;
}

.video-feed video {
    width: 100%;
    height: 100vh;
    object-fit: cover;
    scroll-snap-align: start;
    cursor: pointer;
}

.side-buttons {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    flex-direction: column;
    gap: 15px;
    z-index: 10;
}

.side-buttons button {
    background: rgba(17,17,17,0.7);
    color: #00e676;
    border: none;
    padding: 10px 12px;
    border-radius: 10px;
    font-size: 18px;
    cursor: pointer;
    transition: all 0.2s;
}

.side-buttons button:hover {
    background: #00e676;
    color: #111;
}
</style>

<script>
// ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ŸÑÿ≥ŸÑ
const params = new URLSearchParams(window.location.search);
const seriesName = params.get('series') || 'loveblack';
document.getElementById('series-title').innerText = seriesName;

// ÿ±Ÿàÿßÿ®ÿ∑ RAW ŸÑŸÑŸÅŸäÿØŸäŸàŸáÿßÿ™
const episodes = [
    `https://raw.githubusercontent.com/Alismbot/DevAli.github.io/main/assets/series/${seriesName}/ep1.mp4`,
    `https://raw.githubusercontent.com/Alismbot/DevAli.github.io/main/assets/series/${seriesName}/ep2.mp4`,
    `https://raw.githubusercontent.com/Alismbot/DevAli.github.io/main/assets/series/${seriesName}/ep3.mp4`
];

const feed = document.getElementById("video-feed");

// ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÅŸäÿØŸäŸàŸáÿßÿ™
episodes.forEach(url => {
    const vid = document.createElement("video");
    vid.src = url;
    vid.controls = false;
    vid.autoplay = false;
    vid.loop = false;
    feed.appendChild(vid);

    // ÿπŸÜÿØ ÿßŸÑÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ ÿßŸÑŸÅŸäÿØŸäŸà ŸÑŸÑÿ™ÿ¥ÿ∫ŸäŸÑ / ÿßŸÑÿ•ŸäŸÇÿßŸÅ
    vid.addEventListener('click', () => {
        if (vid.paused) vid.play();
        else vid.pause();
    });
});

// ------------------ Scroll TikTok style ------------------
let currentIndex = 0;
let isSnapping = false;

function snapToIndex(index) {
    const vh = window.innerHeight;
    feed.scrollTo({
        top: index * vh,
        behavior: "smooth"
    });

    document.querySelectorAll(".video-feed video").forEach((v, i) => {
        if (i === index) v.play();
        else {
            v.pause();
            v.currentTime = 0;
        }
    });

    currentIndex = index;
}

// ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑŸÅŸäÿØŸäŸà ÿßŸÑÿ£ŸàŸÑ ÿ™ŸÑŸÇÿßÿ¶Ÿä
window.onload = () => {
    snapToIndex(0);
};

// ÿπŸÜÿØ ÿßŸÑÿ≥ÿ≠ÿ®
let startY = 0;
let isTouching = false;

feed.addEventListener("touchstart", e => {
    startY = e.touches[0].clientY;
    isTouching = true;
});

feed.addEventListener("touchmove", e => {
    e.preventDefault(); // ŸÖŸÜÿπ ÿßŸÑÿ≥ÿ≠ÿ® ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä
});

feed.addEventListener("touchend", e => {
    if (!isTouching) return;
    const endY = e.changedTouches[0].clientY;
    const delta = startY - endY;
    const threshold = window.innerHeight / 4; // Ÿäÿ¨ÿ® ÿßŸÑÿ≥ÿ≠ÿ® ÿ±ÿ®ÿπ ÿßŸÑÿ¥ÿßÿ¥ÿ© ŸÑÿ™ÿ∫ŸäŸäÿ± ÿßŸÑŸÅŸäÿØŸäŸà

    let newIndex = currentIndex;

    if (delta > threshold && currentIndex < episodes.length -1) {
        newIndex = currentIndex +1;
    } else if (delta < -threshold && currentIndex >0) {
        newIndex = currentIndex -1;
    }

    snapToIndex(newIndex);
    isTouching = false;
});
</script>
